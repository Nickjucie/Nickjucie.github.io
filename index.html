<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>TUBES TBA</title>
    <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
    <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
</head>
<body>


<py-script>
    import string

    '''   Lexical Func   ======================================================================================================'''
    def lexical(sentence, check):
        print("L E X I C A L")
        print("--------------------------------------------------------------")
    
        #initialization
        alphabet_list = list(string.ascii_lowercase)
        state_list = ['q0', 'q1', 'q2', 'q3', 'q4', 'q5', 'q6', 'q7', 'q8', 'q9', 'q10', 'q11', 'q12', 'q13', 'q14', 'q15', 'q16', 'q17', 'q18', 'q19', 'q20', 
                  'q21', 'q22', 'q23', 'q24', 'q25', 'q26', 'q27', 'q28', 'q29', 'q31', 'q32']
    
        transition_table = {}
    
        for state in state_list:
            for alphabet in alphabet_list:
                transition_table[(state, alphabet)] = "error"
            transition_table[(state, "#")] = "error"
            transition_table[(state, " ")] = "error"
    
    
        #start state
        transition_table["q0", " "] = "q0"
    
        #finish state
        transition_table[("q6", "#")] = "accepted"
        transition_table[("q6", " ")] = "q7"
    
        transition_table[("q7", "#")] = "accepted"
        transition_table[("q7", " ")] = "q7"
    
        #string makcik
        transition_table[('q0', 'm')]='q1'
        transition_table[('q1', 'a')]='q2'
        transition_table[('q2', 'k')]='q3'
        transition_table[('q3', 'c')]='q4'
        transition_table[('q4', 'i')]='q5'
        transition_table[('q5', 'k')]='q6'
        transition_table[('q6', ' ')]='q7'
        transition_table[('q7', 'm')]='q1'

        #string menunggang
        transition_table[('q0', 'm')]='q1'
        transition_table[('q1', 'e')]='q8'
        transition_table[('q8', 'n')]='q9'
        transition_table[('q9', 'u')]='q10'
        transition_table[('q10', 'n')]='q11'
        transition_table[('q11', 'g')]='q12'
        transition_table[('q12', 'g')]='q13'
        transition_table[('q13', 'a')]='q14'
        transition_table[('q14', 'n')]='q15'
        transition_table[('q15', 'g')]='q6'
        transition_table[('q6', ' ')]='q7'
        transition_table[('q7', 'm')]='q1'

        #string menaip
        transition_table[('q0', 'm')]='q1'
        transition_table[('q1', 'e')]='q8'
        transition_table[('q8', 'n')]='q9'
        transition_table[('q9', 'a')]='q16'
        transition_table[('q16', 'i')]='q17'
        transition_table[('q17', 'p')]='q6'
        transition_table[('q6', ' ')]='q7'
        transition_table[('q7', 'm')]='q1'

        #string saye
        transition_table[('q0', 's')]='q18'
        transition_table[('q18', 'a')]='q19'
        transition_table[('q19', 'y')]='q20'
        transition_table[('q20', 'e')]='q6'
        transition_table[('q6', ' ')]='q7'
        transition_table[('q7', 's')]='q18'

        # string Datuk
        transition_table[('q0', 'd')] = 'q21'
        transition_table[('q21', 'a')] = 'q22'
        transition_table[('q22', 't')] = 'q23'
        transition_table[('q23', 'u')] = 'q24'
        transition_table[('q24', 'k')] = 'q6'
        transition_table[('q6', ' ')] = 'q7'
        transition_table[('q7', 'd')] = 'q21'

        # string Pakcik
        transition_table[('q0', 'p')] = 'q25'
        transition_table[('q25', 'a')] = 'q26'
        transition_table[('q26', 'k')] = 'q27'
        transition_table[('q27', 'c')] = 'q28'
        transition_table[('q28', 'i')] = 'q29'
        transition_table[('q29', 'k')] = 'q6'
        transition_table[('q6', ' ')] = 'q7'
        transition_table[('q7', 'p')] = 'q25'

        # string motosikal
        transition_table[('q0', 'm')] = 'q1'
        transition_table[('q1', 'o')] = 'q30'
        transition_table[('q30', 't')] = 'q31'
        transition_table[('q31', 'o')] = 'q32'
        transition_table[('q32', 's')] = 'q33'
        transition_table[('q33', 'i')] = 'q34'
        transition_table[('q34', 'k')] = 'q35'
        transition_table[('q35', 'a')] = 'q36'
        transition_table[('q36', 'l')] = 'q6'
        transition_table[('q6', ' ')] = 'q7'
        transition_table[('q7', 'm')] = 'q1'

        # string bercakap
        transition_table[('q0', 'b')] = 'q37'
        transition_table[('q37', 'e')] = 'q38'
        transition_table[('q38', 'r')] = 'q39'
        transition_table[('q39', 'c')] = 'q40'
        transition_table[('q40', 'a')] = 'q41'
        transition_table[('q41', 'k')] = 'q42'
        transition_table[('q42', 'a')] = 'q43'
        transition_table[('q43', 'p')] = 'q6'
        transition_table[('q6', ' ')] = 'q7'
        transition_table[('q7', 'b')] = 'q37'

        # string selipar
        transition_table[('q0', 's')] = 'q44'
        transition_table[('q44', 'e')] = 'q45'
        transition_table[('q45', 'l')] = 'q46'
        transition_table[('q46', 'i')] = 'q47'
        transition_table[('q47', 'p')] = 'q48'
        transition_table[('q48', 'a')] = 'q49'
        transition_table[('q49', 'r')] = 'q6'
        transition_table[('q6', ' ')] = 'q7'
        transition_table[('q7', 'b')] = 'q44'

        # string surat
        transition_table[('q0', 's')] = 'q44'
        transition_table[('q44', 'u')] = 'q50'
        transition_table[('q50', 'r')] = 'q51'
        transition_table[('q51', 'a')] = 'q52'
        transition_table[('q52', 't')] = 'q6'
        transition_table[('q6', ' ')] = 'q7'
        transition_table[('q7', 's')] = 'q44'
    
        #lexical analysis
        print()
        idx_char = 0
        state = 'q0'
        current_token = ''

        print("Input terbaru : " + sentence)
        print("__________________________________")

        while state != 'accepted':
            current_char = input_string[idx_char]
            current_token += current_char
            state = transition_table[(state, current_char)]
            if state == 'q6':
                print('current token        : '+ current_token + ', valid')
                current_token = ''
                check = True
            if state == "error":
                print("Input Tidak Valid!")
                check = False
                print("--------------------------------------------------------------")
                break
            idx_char = idx_char + 1
    
        #conclusion
        if state == "accepted":
            print('\nsemua token diinput  : '+ sentence + ', valid')
            check = True
    
        return check
    
        #lexical analysis
        print()
        idx_char = 0
        state = 'q0'
        current_token = ''

        print("Input terbaru : " + sentence)
        print("__________________________________")

        while state != 'accept':
            current_char = input_string[idx_char]
            current_token += current_char
            state = transition_table[(state, current_char)]
            if state == 'q6':
                print('current token        : '+ current_token + ', valid')
                current_token = ''
                check = True
            if state == "error":
                print("Input Tidak Valid!")
                check = False
                print("--------------------------------------------------------------")
                break
            idx_char = idx_char + 1
    
        #conclusion
        if state == "accept":
            print('\nsemua token diinput  : '+ sentence + ', valid')
            check = True
    
        return check
    
    
    
    '''   Parser Func   ======================================================================================================='''
    def parser(sentence, check):
        if check:
            print("\n==============================================================")
            print("                            P A R S E R                            ")
            print("--------------------------------------------------------------")
    
            tokens = sentence.lower().split()
            tokens.append('EOS')
    
            non_terminals = ['S', 'NN', 'VB', 'OB']
            test = ['NN', 'VB', 'OB']
            tError = ['error']
            terminals = ['abdi', 'anjeun', 'indung', 'bapa', 'maca', 'tuang', 'mawa', 'buku', 'cau', 'sangu', 'kembang']
    
            parse_table = {}
    
            parse_table[('S', 'abdi')] = test
            parse_table[('S', 'anjeun')] = test
            parse_table[('S', 'indung')] = test
            parse_table[('S', 'bapa')] = test
            parse_table[('S', 'maca')] = tError
            parse_table[('S', 'tuang')] = tError
            parse_table[('S', 'mawa')] = tError
            parse_table[('S', 'buku')] = test
            parse_table[('S', 'cau')] = test
            parse_table[('S', 'sangu')] = test
            parse_table[('S', 'kembang')] = test
            parse_table[('S', 'EOS')] = tError
    
            parse_table[('NN', 'abdi')] = ['abdi']
            parse_table[('NN', 'anjeun')] = ['anjeun']
            parse_table[('NN', 'indung')] = ['indung']
            parse_table[('NN', 'bapa')] = ['bapa']
            parse_table[('NN', 'maca')] = tError
            parse_table[('NN', 'tuang')] = tError
            parse_table[('NN', 'mawa')] = tError
            parse_table[('NN', 'buku')] = tError
            parse_table[('NN', 'cau')] = tError
            parse_table[('NN', 'sangu')] = tError
            parse_table[('NN', 'kembang')] = tError
            parse_table[('NN', 'EOS')] = tError
    
            parse_table[('VB', 'abdi')] = tError
            parse_table[('VB', 'anjeun')] = tError
            parse_table[('VB', 'indung')] = tError
            parse_table[('VB', 'bapa')] = tError
            parse_table[('VB', 'maca')] = ['maca']
            parse_table[('VB', 'tuang')] = ['tuang']
            parse_table[('VB', 'mawa')] = ['mawa']
            parse_table[('VB', 'buku')] = tError
            parse_table[('VB', 'cau')] = tError
            parse_table[('VB', 'sangu')] = tError
            parse_table[('VB', 'kembang')] = tError
            parse_table[('VB', 'EOS')] = tError
    
            parse_table[('OB', 'abdi')] = tError
            parse_table[('OB', 'anjeun')] = tError
            parse_table[('OB', 'indung')] = tError
            parse_table[('OB', 'bapa')] = tError
            parse_table[('OB', 'maca')] = tError
            parse_table[('OB', 'tuang')] = tError
            parse_table[('OB', 'mawa')] = tError
            parse_table[('OB', 'buku')] = ['buku']
            parse_table[('OB', 'cau')] = ['cau']
            parse_table[('OB', 'sangu')] = ['sangu']
            parse_table[('OB', 'kembang')] = ['kembang']
            parse_table[('OB', 'EOS')] = tError
    
            stack = []
            stack.append('#')
            stack.append('S')
    
            index_token = 0
            symbol = tokens[index_token]
    
            while(len(stack) > 0):
                top = stack[ len(stack) - 1 ]
    
                print("top = "+ top)
                print("symbol = " + symbol)
    
                if top in terminals:
                    print('top adalah simbol terminal')
                    
                    if top == symbol:
                        stack.pop()
                        index_token = index_token + 1
                        symbol = tokens[index_token]
    
                        if symbol == "EOS":
                            stack.pop()
                            print('isi stack:', stack)
    
                    else:
                        print('error')
                        break
    
                elif top in non_terminals:
                    print('top adalah symbol non-terminal')
    
                    if parse_table[(top, symbol)][0] != 'error':
                        stack.pop()
                        symbol_to_be_pushed = parse_table[(top, symbol)]
    
                        for i in range(len(symbol_to_be_pushed)-1, -1, -1):
                            stack.append(symbol_to_be_pushed[i])
    
                    else:
                        print('error')
                        break
    
                else:
                    print('error')
                    break
    
                print('isi stack: ', stack)
                print("--------------------------------------------------------------")
    
            if symbol == 'EOS' and len(stack) == 0:
                print('input string : '+ '"'+ sentence + '"'+ ', diterima, sesuai grammar')
                
            else:
                print("--------------------------------------------------------------")
                print('error', 'input string:' + '"'+ sentence+ '"'+ ', tidak diterima, tidak sesuai grammar')  
        else:
            pass
    
        print("==============================================================\n")
    
        return parser
    
    
    
    '''   Main Program   ======================================================================================================'''
    check = False
    while check != True:
        sentence = input()
        input_string = sentence.lower() + '#'
        check = lexical(sentence, check)

    parser(sentence, check)

</py-script>
</body>
</html>
